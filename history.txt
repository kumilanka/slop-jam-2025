2025-11-28
- Planned Unity 6 top-down shooter architecture from Plan.txt brief.
- Scaffolded Assets folders and implemented core services (ServiceLocator, Startup, InputService fallback to legacy input, EventBus).
- Built player systems: HealthComponent, PlayerConfig/Runtime, PlayerController (now pure XY movement/rotation), Weapon pipeline with SO definitions and projectile handling converted to Rigidbody2D.
- Created enemy configs/brains/spawner plus DamageSystem/request flow.
- Added GameDirector orchestrator and UI Toolkit HUD/GameOver document (GameHUD.uxml/uss) with HUDDocumentView, wiring controllers to UI.
- Iterated on input/aim/shoot issues: legacy input support, direct movement, 2D aiming, projectile spawning warnings, Rigidbody2D collisions, corrected rotation to match mouse.
- Fixed player rotation issue where `Camera.main` was picking up the Bootstrap camera instead of the Gameplay camera; removed redundant Main Camera from Bootstrap scene.
- Fixed enemy spawning and HUD initialization failures caused by missing GameDirector in the scene; implemented self-initialization fallbacks in EnemySpawner and HUDController.
- Updated player graphics to use `character_right` sprite from `character.png` and adjusted rotation offset to 0.
- Implemented directional sprite swapping in PlayerController; added fields for Up/Down/Left/Right sprites and separated aim rotation (via AimPivot) from body visual orientation.
- Debugged "enemies not spawning" issue; found `EnemyBrain` was using 3D movement logic (zeroing Y axis, rotating Forward) which likely made them invisible/stuck. Fixed to use 2D XY movement and Z-axis rotation. Added debug logs to EnemySpawner.
- Fixed "ammo not hitting enemies" bug by setting Projectile collider to Trigger, adding BoxCollider2D to Enemy prefab, and removing duplicate HealthComponent from Enemy.
- Fixed "game continues after 0 health" bug by making GameOverView self-initialize and subscribe to Player death event (bypassing missing GameDirector).
- Refactored sprite swapping logic into a generic `DirectionalSprite` component. Refactored `PlayerController` to use it, and attached it to `Player.prefab` and `Enemy.prefab` to support directional sprites for all characters.
- Fixed Player sprite locking issue by disabling `autoUpdateFromSelf` in DirectionalSprite component on Player prefab.
- Restored missing `BoxCollider2D` on Enemy prefab.
- Added `DestroyOnDeath` component to Enemy prefab to ensure enemies disappear when killed.
- Implemented on-hit damage flash effect using `DamageFlash` component; attached to Player and Enemy prefabs.
